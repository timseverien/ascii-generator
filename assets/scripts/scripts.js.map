{"version":3,"sources":["scripts.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","value","_AsciiFactory","_AsciiFactory2","_CharacterSetFactory","_CharacterSetFactory2","_ImageFactory","_ImageFactory2","_CanvasService","_CanvasService2","App","options","_this","this","inputFileElement","inputFilePreviewElement","inputCharacterSetElement","inputSizeElement","inputLineHeightElement","characterSetRangeElement","btnPreset","btnStartElement","outputElement","addInputEventListeners","setCharacterSetFromPreset","getPresets","ascii","addEventListener","isValid","generateAscii","files","then","innerHTML","escapeHtml","_this2","parentNode","classList","remove","getImageFromFile","image","style","backgroundImage","src","add","_loop","charset","presets","LINE_HEIGHT","selectCharacterSet","characterSet","join","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","character","indexOf","push","err","getCharacterSet","canvas","context","getContext","lightnessRangeCount","maxLightnessCount","characterLightnessSet","normalizeCharacterLightness","getCharacterLightnessSet","FONT_SIZE","sort","b","lightness","forEach","lightnessString","Math","floor","toString","max","height","width","clearRect","strokeStyle","x","moveTo","lineTo","stroke","file","_this3","Promise","resolve","reject","getCanvasFromImage","imageData","getImageData","imageLightnessData","getImageLightnessData","data","normalizeLightness","window","worker","Worker","onmessage","postMessage","getAscii","console","error","emoji","latin","Array","concat","html","replace","isNaN","parseInt","parseFloat","./factories/AsciiFactory","./factories/CharacterSetFactory","./factories/ImageFactory","./services/CanvasService",2,"AsciiFactory","find","match","abs",3,"CharacterSetFactory","start","end","String","fromCodePoint",4,"ImageFactory","reader","FileReader","Image","result","readAsDataURL",5,"CanvasService","document","createElement","round","fillStyle","fillRect","drawImage","fontSize","fontStyle","fillText","getCanvasLightness","filter","lightnessData","forEachPixel","g","sum","previous","current","reduce","callback","pixelData","lightnessMin","Infinity","lightnessMax","min","map"],"mappings":"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","file":"scripts.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _AsciiFactory = require('./factories/AsciiFactory');\n\nvar _AsciiFactory2 = _interopRequireDefault(_AsciiFactory);\n\nvar _CharacterSetFactory = require('./factories/CharacterSetFactory');\n\nvar _CharacterSetFactory2 = _interopRequireDefault(_CharacterSetFactory);\n\nvar _ImageFactory = require('./factories/ImageFactory');\n\nvar _ImageFactory2 = _interopRequireDefault(_ImageFactory);\n\nvar _CanvasService = require('./services/CanvasService');\n\nvar _CanvasService2 = _interopRequireDefault(_CanvasService);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar App = (function () {\n    function App(options) {\n        var _this = this;\n\n        _classCallCheck(this, App);\n\n        this.inputFileElement = options.inputFileElement;\n        this.inputFilePreviewElement = options.inputFilePreviewElement;\n        this.inputCharacterSetElement = options.inputCharacterSetElement;\n        this.inputSizeElement = options.inputSizeElement;\n        this.inputLineHeightElement = options.inputLineHeightElement;\n        this.characterSetRangeElement = options.characterSetRangeElement;\n        this.btnPreset = options.btnPreset;\n        this.btnStartElement = options.btnStartElement;\n        this.outputElement = options.outputElement;\n\n        this.addInputEventListeners();\n        this.setCharacterSetFromPreset(this.getPresets().ascii);\n\n        this.btnStartElement.addEventListener('click', function () {\n            if (!_this.isValid()) return;\n\n            _this.generateAscii(_this.inputFileElement.files[0]).then(function (ascii) {\n                _this.outputElement.innerHTML = _this.escapeHtml(ascii);\n            });\n        });\n    }\n\n    _createClass(App, [{\n        key: 'addInputEventListeners',\n        value: function addInputEventListeners() {\n            var _this2 = this;\n\n            this.inputFileElement.addEventListener('change', function () {\n                if (!_this2.inputFileElement.files.length) return;\n\n                _this2.inputFileElement.parentNode.classList.remove('form__control--error');\n\n                _ImageFactory2.default.getImageFromFile(_this2.inputFileElement.files[0]).then(function (image) {\n                    _this2.inputFilePreviewElement.style.backgroundImage = 'url(' + image.src + ')';\n                    _this2.inputFilePreviewElement.parentNode.classList.add('file-uploader--preview');\n                });\n            });\n\n            this.inputCharacterSetElement.addEventListener('change', function () {\n                _this2.inputCharacterSetElement.classList.remove('form__control--error');\n            });\n\n            this.inputCharacterSetElement.addEventListener('change', function () {\n                _this2.inputCharacterSetElement.classList.remove('form__control--error');\n            });\n\n            var _loop = function _loop(charset) {\n                _this2.btnPreset[charset].addEventListener('click', function () {\n                    var presets = _this2.getPresets();\n                    _this2.setCharacterSetFromPreset(presets[charset]);\n                    _this2.inputLineHeightElement.value = App.LINE_HEIGHT[charset];\n                });\n            };\n\n            for (var charset in this.btnPreset) {\n                _loop(charset);\n            }\n\n            this.inputCharacterSetElement.addEventListener('change', function () {\n                return _this2.selectCharacterSet();\n            });\n            this.inputCharacterSetElement.addEventListener('keyup', function () {\n                return _this2.selectCharacterSet();\n            });\n        }\n    }, {\n        key: 'setCharacterSetFromPreset',\n        value: function setCharacterSetFromPreset(characterSet) {\n            this.inputCharacterSetElement.value = characterSet.join('');\n            this.selectCharacterSet();\n        }\n    }, {\n        key: 'getCharacterSet',\n        value: function getCharacterSet() {\n            var characterSet = [];\n\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n                for (var _iterator = this.inputCharacterSetElement.value[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                    var character = _step.value;\n\n                    if (characterSet.indexOf(character) >= 0) continue;\n                    characterSet.push(character);\n                }\n            } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                    }\n                } finally {\n                    if (_didIteratorError) {\n                        throw _iteratorError;\n                    }\n                }\n            }\n\n            return characterSet;\n        }\n    }, {\n        key: 'selectCharacterSet',\n        value: function selectCharacterSet() {\n            var characterSet = this.getCharacterSet(),\n                canvas = this.characterSetRangeElement,\n                context = canvas.getContext('2d'),\n                lightnessRangeCount = {};\n            var maxLightnessCount = 0;\n\n            this.characterLightnessSet = _CanvasService2.default.normalizeCharacterLightness(_CanvasService2.default.getCharacterLightnessSet(characterSet, App.FONT_SIZE));\n            this.characterLightnessSet = this.characterLightnessSet.sort(function (a, b) {\n                return b.lightness - a.lightness;\n            });\n\n            this.characterLightnessSet.forEach(function (character) {\n                var lightnessString = Math.floor(character.lightness * characterSet.length).toString();\n\n                if (!lightnessRangeCount[lightnessString]) {\n                    lightnessRangeCount[lightnessString] = 0;\n                }\n\n                lightnessRangeCount[lightnessString]++;\n                maxLightnessCount = Math.max(lightnessRangeCount[lightnessString], maxLightnessCount);\n            });\n\n            canvas.height = 25;\n            canvas.width = characterSet.length;\n\n            context.clearRect(0, 0, canvas.width, canvas.height);\n            context.strokeStyle = 'rgba(0, 0, 0, .5)';\n\n            for (var x in lightnessRangeCount) {\n                context.moveTo(x, canvas.height);\n                context.lineTo(x, canvas.height - lightnessRangeCount[x] / maxLightnessCount * canvas.height);\n            }\n\n            context.stroke();\n        }\n    }, {\n        key: 'generateAscii',\n        value: function generateAscii(file) {\n            var _this3 = this;\n\n            return new Promise(function (resolve, reject) {\n                _ImageFactory2.default.getImageFromFile(file).then(function (image) {\n                    var width = _this3.inputSizeElement.value,\n                        height = width / image.width * image.height / _this3.inputLineHeightElement.value,\n                        canvas = _CanvasService2.default.getCanvasFromImage(image, width, height),\n                        context = canvas.getContext('2d'),\n                        imageData = context.getImageData(0, 0, canvas.width, canvas.height),\n                        imageLightnessData = _CanvasService2.default.getImageLightnessData(imageData);\n\n                    imageLightnessData.data = _CanvasService2.default.normalizeLightness(imageLightnessData.data);\n\n                    if ('Worker' in window) {\n                        var worker = new Worker('assets/scripts/ascii-factory.js');\n                        worker.onmessage = function (e) {\n                            return resolve(e.data);\n                        };\n                        worker.postMessage({\n                            characterLightnessSet: _this3.characterLightnessSet,\n                            imageLightnessData: imageLightnessData\n                        });\n                    } else {\n                        resolve(_AsciiFactory2.default.getAscii(_this3.characterLightnessSet, imageLightnessData));\n                    }\n                }).catch(function (e) {\n                    console.error(e);\n                });\n            });\n        }\n    }, {\n        key: 'getPresets',\n        value: function getPresets() {\n            return {\n                ascii: _CharacterSetFactory2.default.getCharacterSet(0x20, 0x7E),\n\n                // TODO: Add more emoji\n                // Source: https://en.wikipedia.org/wiki/Emoji#In_the_Unicode_standard\n                emoji: _CharacterSetFactory2.default.getCharacterSet(0x1F600, 0x1F64F),\n                latin: Array.prototype.concat(_CharacterSetFactory2.default.getCharacterSet(0x20, 0x7E), _CharacterSetFactory2.default.getCharacterSet(0xA1, 0x17F))\n            };\n        }\n    }, {\n        key: 'escapeHtml',\n        value: function escapeHtml(html) {\n            return html.replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n        }\n    }, {\n        key: 'isValid',\n        value: function isValid() {\n            var isValid = true;\n\n            if (!this.inputFileElement.files || this.inputFileElement.files.length === 0) {\n                this.inputFileElement.parentNode.classList.add('form__control--error');\n                isValid = false;\n            }\n\n            if (!this.inputCharacterSetElement.value) {\n                this.inputCharacterSetElement.classList.add('form__control--error');\n                isValid = false;\n            }\n\n            if (isNaN(parseInt(this.inputSizeElement.value)) || this.inputSizeElement.value < 2) {\n                this.inputSizeElement.classList.add('form__control--error');\n                isValid = false;\n            }\n\n            if (isNaN(parseFloat(this.inputLineHeightElement.value))) {\n                this.inputLineHeightElement.classList.add('form__control--error');\n                isValid = false;\n            }\n\n            return isValid;\n        }\n    }]);\n\n    return App;\n})();\n\nexports.default = App;\n\nApp.FONT_SIZE = 12;\nApp.LINE_HEIGHT = {\n    ascii: 1.8,\n    latin: 1.8,\n    emoji: 1.2\n};\n\nwindow.App = App;\n\n},{\"./factories/AsciiFactory\":2,\"./factories/CharacterSetFactory\":3,\"./factories/ImageFactory\":4,\"./services/CanvasService\":5}],2:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar AsciiFactory = (function () {\n    function AsciiFactory() {\n        _classCallCheck(this, AsciiFactory);\n    }\n\n    _createClass(AsciiFactory, null, [{\n        key: 'getAscii',\n        value: function getAscii(characterLightnessSet, imageLightnessData) {\n            var ascii = '',\n                find = function find(lightness) {\n                var match = undefined;\n\n                characterLightnessSet.forEach(function (character) {\n                    if (match && Math.abs(lightness - character.lightness) >= Math.abs(lightness - match.lightness)) return;\n\n                    match = character;\n                });\n\n                return match.character;\n            };\n\n            imageLightnessData.data.forEach(function (lightness, i) {\n                if (i > 0 && i % imageLightnessData.width === 0) {\n                    ascii += '\\r\\n';\n                }\n\n                ascii += find(lightness);\n            });\n\n            return ascii;\n        }\n    }]);\n\n    return AsciiFactory;\n})();\n\nexports.default = AsciiFactory;\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar CharacterSetFactory = (function () {\n    function CharacterSetFactory() {\n        _classCallCheck(this, CharacterSetFactory);\n    }\n\n    _createClass(CharacterSetFactory, null, [{\n        key: \"getCharacterSet\",\n        value: function getCharacterSet(start, end) {\n            var characterSet = [];\n\n            for (var i = start; i <= end; i++) {\n                characterSet.push(String.fromCodePoint(i));\n            }\n\n            return characterSet;\n        }\n    }]);\n\n    return CharacterSetFactory;\n})();\n\nexports.default = CharacterSetFactory;\n\n},{}],4:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ImageFactory = (function () {\n    function ImageFactory() {\n        _classCallCheck(this, ImageFactory);\n    }\n\n    _createClass(ImageFactory, null, [{\n        key: 'getImageFromFile',\n        value: function getImageFromFile(file) {\n            var reader = new FileReader(),\n                image = new Image();\n\n            return new Promise(function (resolve, reject) {\n                reader.addEventListener('load', function () {\n                    image.src = reader.result;\n                });\n\n                image.addEventListener('load', function () {\n                    resolve(image);\n                });\n\n                reader.addEventListener('error', reject);\n                image.addEventListener('error', reject);\n                reader.readAsDataURL(file);\n            });\n        }\n    }]);\n\n    return ImageFactory;\n})();\n\nexports.default = ImageFactory;\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar CanvasService = (function () {\n    function CanvasService() {\n        _classCallCheck(this, CanvasService);\n    }\n\n    _createClass(CanvasService, null, [{\n        key: 'getCanvasFromImage',\n        value: function getCanvasFromImage(image, width, height) {\n            var canvas = document.createElement('canvas'),\n                context = canvas.getContext('2d');\n\n            canvas.height = Math.round(height);\n            canvas.width = Math.round(width);\n\n            context.fillStyle = '#fff';\n            context.fillRect(0, 0, canvas.width, canvas.height);\n            context.drawImage(image, 0, 0, canvas.width, canvas.height);\n\n            return canvas;\n        }\n    }, {\n        key: 'getCharacterLightnessSet',\n        value: function getCharacterLightnessSet(characterSet, fontSize) {\n            var canvas = document.createElement('canvas'),\n                context = canvas.getContext('2d'),\n                characterLightnessSet = [];\n\n            canvas.height = fontSize;\n            canvas.width = fontSize;\n\n            context.fontStyle = fontSize + 'px monospace';\n\n            characterSet.forEach(function (character) {\n                context.fillStyle = '#fff';\n                context.fillRect(0, 0, canvas.width, canvas.height);\n\n                context.fillStyle = '#000';\n                context.fillText(character, 0, canvas.height);\n\n                var imageData = context.getImageData(0, 0, canvas.width, canvas.height);\n                characterLightnessSet.push({\n                    character: character,\n                    lightness: CanvasService.getCanvasLightness(imageData)\n                });\n            });\n\n            return characterLightnessSet.filter(function (character) {\n                return character.lightness > 0 || character.character === 0x20;\n            });\n        }\n    }, {\n        key: 'getImageLightnessData',\n        value: function getImageLightnessData(imageData) {\n            var lightnessData = [];\n\n            CanvasService.forEachPixel(imageData, function (r, g, b, a) {\n                lightnessData.push((r + g + b) / 3);\n            });\n\n            return {\n                data: lightnessData,\n                height: imageData.height,\n                width: imageData.width\n            };\n        }\n    }, {\n        key: 'getCanvasLightness',\n        value: function getCanvasLightness(imageData) {\n            var imageLightnessData = CanvasService.getImageLightnessData(imageData),\n                sum = function sum(previous, current) {\n                return previous + current;\n            };\n\n            return imageLightnessData.data.reduce(sum, 0) / imageLightnessData.data.length;\n        }\n    }, {\n        key: 'forEachPixel',\n        value: function forEachPixel(imageData, callback) {\n            var pixelData = imageData.data;\n\n            for (var i = 0; i < pixelData.length; i += 4) {\n                callback(pixelData[i], pixelData[i + 1], pixelData[i + 2], pixelData[i + 3], i);\n            }\n        }\n    }, {\n        key: 'normalizeCharacterLightness',\n        value: function normalizeCharacterLightness(lightnessData) {\n            var lightnessMin = Infinity,\n                lightnessMax = -Infinity;\n\n            lightnessData.forEach(function (obj) {\n                lightnessMin = Math.min(obj.lightness, lightnessMin);\n                lightnessMax = Math.max(obj.lightness, lightnessMax);\n            });\n\n            return lightnessData.map(function (obj) {\n                obj.lightness = (obj.lightness - lightnessMin) / (lightnessMax - lightnessMin);\n                return obj;\n            });\n        }\n    }, {\n        key: 'normalizeLightness',\n        value: function normalizeLightness(lightnessData) {\n            var lightnessMin = Infinity,\n                lightnessMax = -Infinity;\n\n            lightnessData.forEach(function (lightness) {\n                lightnessMin = Math.min(lightness, lightnessMin);\n                lightnessMax = Math.max(lightness, lightnessMax);\n            });\n\n            return lightnessData.map(function (lightness) {\n                return (lightness - lightnessMin) / (lightnessMax - lightnessMin);\n            });\n        }\n    }]);\n\n    return CanvasService;\n})();\n\nexports.default = CanvasService;\n\n},{}]},{},[1]);\n"],"sourceRoot":"/source/"}